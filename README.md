# Gestão de Refeições
#### Centro de Comunicações e Informação

###### Desenvolvido em
[![Laravel|Solid](data:image/png;base64,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)](https://laravel.com/)

[![Build Status](https://travis-ci.org/joemccann/dillinger.svg?branch=master)](http://intranet.exercito.local/)

Esta aplicação permite a marcação de refeições, a consulta de estatisticas, o pedido de refeições para
elementos externos, entre outros.

## Funcionalidades

- Publicação de ementas via um ficheiro EXCEL.
- Gestão e actualização da informação dos utilizadores via um ficheiro EXCEL.
- Criação de hóspedes e marcação de refeições para os mesmos nas messes militares.
- Pedidos de refeições quantitativos para elementos externos (ex: candidatos)-
- Gestão de permissões para grupos de utilizadores (SecPess, SecLog, SecAlim, etc...)-
- Consulta de estatísticas (consoante o nivel de permissões) dos locais de refeição.
- Personalização de conta.
- Herdar utilizadores para gestão e marcação de refeição para os mesmos.
- Definir periodos de marcação e remoção de marcações.
- Distribuíção automatica de emails numa alteração de ementa.
- Bloqueio de contas, e impedimento de marcação de refeições.
- Criação de relatórios PDF, optimizados para impressão.
- Entre outras...


## Tecnologia

Esta aplicação utiliza outros projectos open-source para funcionar correctamente:

- [Laravel 8.45.1](https://laravel.com/) - Framework de back-end e acesso a DB.
- [PHP 8.0.2](https://www.php.net/) - Linguagem de programação utilizada para servidor.
- [MariaDB 10.5](https://mariadb.org/) - MariaDB é um SGDB que surgiu como fork do MySQL.
- [AdminLTE 3.0](https://adminlte.io/) - Template HTML responsivo para ser utilizado em painéis administrativos.
- [jQuery 3.4.1](https://jquery.com/) - jQuery é uma biblioteca de funções JavaScript que interage com o HTML, desenvolvida para simplificar os scripts interpretados no navegador do cliente.
- [BootStrap 3](https://getbootstrap.com/docs/3.3/) - Bootstrap é um framework web com código-fonte aberto para desenvolvimento de componentes de interface.
- [barryvdh/laravel-dompdf 0.9.0](https://github.com/barryvdh/laravel-dompdf) - Criação de ficheiros PDF a partir de uma página HTML.
- [maatwebsite/excel 3.1.31](https://github.com/Maatwebsite/Laravel-Excel) - Leitura de ficheiros EXCEL.

## Installation

Esta aplicação requere [Composer](https://getcomposer.org//) para a gestão de pacotes.

Para uma instalação mais facil do servidor, é recomendado o instalador referenciado no Manual de Desenvolvimento.

###### Hospedagem para DEPLOY
#
```
-Copie todo o conteúdo da pasta C:\xampp\htdocs\
    para a pasta C:\xampp\migration\app\files\htdocs\

- Abra a aplicação HeidiSQL, e no painel á esquerda,
    com o botao direito do rato em cima da base de dados
    ‘cmdpessunap_alim_manager’, e selecione a opção
    ‘Exportar base de dados como SQL’;

- Selecione DATABASE(s) e TABLE(s) em ‘CREATE’,
    DATA como ‘Insert ignore’, Max INSERT size em ‘1024’,
    o OUTPUT como ‘Single .sql le’, e por ultimo,
    e Nome de cheiro, clique na pasta à direita,
    e guarde num dispositivo USB;

- Clique em ‘Guardar’, e de seguida em ‘Exportar’;

- Copie a pasta C:\xampp\migration\app para o mesmo
    dispostivo USB, e leve esse dispositivo USB para a nova
    máquina;

- Na nova maquina, aceda ao dispositivo USB, e corra o executavél
    numa conta com direitos de admistrador;

- Neste processo, o sistema irá reiniciar várias vezes. Sempre que
    reiníciar, abra novamente o executável, o processo de
    setup irá continuar;

- Preste atenção às indicações dadas pelo o programa, como desactivar
    a instalação de MySQL quando estiver a instalar o XAMPP, a
    password do sistema MariaDB e de activar o acesso remoto.
    Faça o procedimento inteiro, no final irá abrir-lhe o sistema XAMPP
    já com a configuração correcta, com a plataforma hospedada,
    no entanto, falta importar a base de dados.

- Na nova máquina, abra o HeidiSQL (terá sido instalado pela ferramenta
    de migração automática), inicie sessão com as credenciais ROOT,
    e de seguida, na barra superior, carrega em ‘Ficheiro’ > ‘Run SQL
    File’. Confirme que as tabelas foram criadas e populadas.
    Se o processo estiver feito correctamente, a aplicação já estará
    disponível no endereço:
    (IP DA NOVA MAQUINA):81/alim
```

###### Hospedagem para DEBUG
#

```cmd
- Faça os procedimentos acima, mas encerre o XAMPP.
    De seguida, abra uma janela de linha de comandos (cmd.exe) e insira os seguintes comandos:
        cd C:\xampp\htdocs\alim
        php artisan serve --host=(IP DA MAQUINA)

- Se não souber o IP da máquina actual, pode consultar também no CMD com o comando: ipconfig

- Executando o comando SERVE, irá ser iniciado um servidor de desenvolvimento local.
```

## Comandos ARTISAN

Aqui dispoêm uma lista dos comandos mais uteis para DEBUG da aplicação.

| Comando | Funcionalidade |
| ------ | ------ |
| php artisan optimize:clear | Limpa a cache da aplicação (do dirétorio ‘storage’). |
| php artisan config:cache | Cria um ficheiro cache da configuração de pacotes. |
| php artisan key:generate | Cria uma nova chave de encriptação de Session e Cookies. |
| php artisan down | Coloca a aplicação em modo de manutenção. Os utilizadores não iram conseguir aceder. |
| php artisan up | Retira a aplicação do modo de manutenção. Os utilizadores voltam a conseguir aceder. |
| php artisan tinker | Permite executar código PHP a partir do terminal, interagindo com a aplicação. |
| php artisan route:cache | Cria um ficheiro de cache das routes para um acesso mais rápido. |

## Segurança aplicacional

A aplicação utiliza vários tipos de encriptação e criptografia para garantir
a segurança dos dados dos utilizadores.
Aqui dispôem de uma lista dos principais elementos a ser encriptados\criptografados

| Elemento | Criptografia |  Encriptação |  Codificação |
| ------ | ------ | ------ | ------ |  
| Variáveis de sessão e Pedidos | OpenSSL | AES-256-CBC |✗|
| Cookies |✗| SHA-256 |✗|
| Passwords e tokens | BCrypt | Argon2 |✗|
| Referencias e outros |✗| CRC326 |✗|
| Páginas HTML |✗|✗| base64 encoding |


> Nota: Aplicação integrada de migração apenas irá migrar a aplicação
de Gestão de Refeições, NÃO irá migrar outras aplicações no servidor interno de gestão

Para verificar que tudo foi migrado com sucesso, abra o browser no mesmo computador
e insira um dos seguintes link:

```sh
- 127.0.0.1:81/alim
- (IP DA MÁQUINA):81/alim
- LOCALHOST:81/alim
```

##### Unidade de Apoio do Comando do Pessoal - Exército Português
